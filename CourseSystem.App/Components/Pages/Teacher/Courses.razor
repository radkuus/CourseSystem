@page "/teacher/courses"
@using CourseSystem.App.Services
@using CourseSystem.App.Components.Auth
@using CourseSystem.App.Models
@inject AuthenticationService AuthService
@inject NavigationManager Navigation
@attribute [Microsoft.AspNetCore.Authorization.Authorize]

<PageTitle>Moje Kursy - Panel Nauczyciela</PageTitle>

@if (AuthState?.User != null)
{
    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>Moje Kursy</h1>
            <button class="btn btn-success">
                <i class="bi bi-plus-circle"></i> Stwórz nowy kurs
            </button>
        </div>

        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Filtry</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <label class="form-label">Rok akademicki</label>
                                <select class="form-select">
                                    <option>Wszystkie</option>
                                    <option>2024/2025</option>
                                    <option>2023/2024</option>
                                    <option>2022/2023</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Status</label>
                                <select class="form-select">
                                    <option>Wszystkie</option>
                                    <option>Aktywne</option>
                                    <option>Nieaktywne</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Szukaj</label>
                                <input type="text" class="form-control" placeholder="Nazwa kursu...">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            @* Przykładowy kurs 1 *@
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title">Programowanie Obiektowe</h5>
                            <span class="badge bg-success">Aktywny</span>
                        </div>
                        <h6 class="card-subtitle mb-2 text-muted">Rok akademicki: 2024/2025</h6>
                        <p class="card-text">Kurs wprowadzający do programowania obiektowego w języku C#. Obejmuje podstawy OOP, wzorce projektowe i najlepsze praktyki.</p>

                        <div class="row text-center mb-3">
                            <div class="col-4">
                                <div class="text-muted">Studenci</div>
                                <div class="fs-4 fw-bold">32</div>
                            </div>
                            <div class="col-4">
                                <div class="text-muted">Zadania</div>
                                <div class="fs-4 fw-bold">8</div>
                            </div>
                            <div class="col-4">
                                <div class="text-muted">Do oceny</div>
                                <div class="fs-4 fw-bold text-danger">12</div>
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button class="btn btn-primary btn-sm flex-fill">Zarządzaj</button>
                            <button class="btn btn-outline-secondary btn-sm">Edytuj</button>
                            <button class="btn btn-outline-danger btn-sm">Archiwizuj</button>
                        </div>
                    </div>
                </div>
            </div>

            @* Przykładowy kurs 2 *@
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title">Bazy Danych</h5>
                            <span class="badge bg-success">Aktywny</span>
                        </div>
                        <h6 class="card-subtitle mb-2 text-muted">Rok akademicki: 2024/2025</h6>
                        <p class="card-text">Podstawy projektowania i zarządzania bazami danych SQL. Normalizacja, optymalizacja zapytań, transakcje.</p>

                        <div class="row text-center mb-3">
                            <div class="col-4">
                                <div class="text-muted">Studenci</div>
                                <div class="fs-4 fw-bold">28</div>
                            </div>
                            <div class="col-4">
                                <div class="text-muted">Zadania</div>
                                <div class="fs-4 fw-bold">5</div>
                            </div>
                            <div class="col-4">
                                <div class="text-muted">Do oceny</div>
                                <div class="fs-4 fw-bold text-danger">8</div>
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button class="btn btn-primary btn-sm flex-fill">Zarządzaj</button>
                            <button class="btn btn-outline-secondary btn-sm">Edytuj</button>
                            <button class="btn btn-outline-danger btn-sm">Archiwizuj</button>
                        </div>
                    </div>
                </div>
            </div>

            @* Przykładowy kurs 3 - nieaktywny *@
            <div class="col-md-6 mb-4">
                <div class="card h-100 opacity-75">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title">Algorytmy i Struktury Danych</h5>
                            <span class="badge bg-secondary">Nieaktywny</span>
                        </div>
                        <h6 class="card-subtitle mb-2 text-muted">Rok akademicki: 2023/2024</h6>
                        <p class="card-text">Zaawansowany kurs dotyczący algorytmów sortowania, przeszukiwania i struktur danych.</p>

                        <div class="row text-center mb-3">
                            <div class="col-4">
                                <div class="text-muted">Studenci</div>
                                <div class="fs-4 fw-bold">45</div>
                            </div>
                            <div class="col-4">
                                <div class="text-muted">Zadania</div>
                                <div class="fs-4 fw-bold">12</div>
                            </div>
                            <div class="col-4">
                                <div class="text-muted">Do oceny</div>
                                <div class="fs-4 fw-bold">0</div>
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button class="btn btn-secondary btn-sm flex-fill" disabled>Zarządzaj</button>
                            <button class="btn btn-outline-secondary btn-sm">Przywróć</button>
                            <button class="btn btn-outline-danger btn-sm">Usuń</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @* Sekcja statystyk *@
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Podsumowanie</h5>
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="text-muted">Wszystkie kursy</div>
                                <div class="fs-3 fw-bold">3</div>
                            </div>
                            <div class="col-md-3">
                                <div class="text-muted">Aktywne kursy</div>
                                <div class="fs-3 fw-bold text-success">2</div>
                            </div>
                            <div class="col-md-3">
                                <div class="text-muted">Łącznie studentów</div>
                                <div class="fs-3 fw-bold">105</div>
                            </div>
                            <div class="col-md-3">
                                <div class="text-muted">Zadania do oceny</div>
                                <div class="fs-3 fw-bold text-danger">20</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@code {
    [CascadingParameter] private AuthorizeViewProvider.AuthState? AuthState { get; set; }

    protected override void OnInitialized()
    {
        // Sprawdź czy użytkownik ma odpowiednią rolę
        if (AuthState?.User?.Role.ToLower() != "teacher")
        {
            Navigation.NavigateTo("/");
        }
    }
}

<style>
    .bi-plus-circle::before {
        content: "➕ ";
    }
</style>